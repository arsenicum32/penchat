function retina(){if(1!==window.devicePixelRatio){var t=canvas.getElement(),e=t.width,n=t.height;t.setAttribute("width",e*window.devicePixelRatio),t.setAttribute("height",n*window.devicePixelRatio),t.getContext("2d").scale(window.devicePixelRatio,window.devicePixelRatio)}canvas.renderAll()}function clip(t){var e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("value",t),e=document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(n){e.remove(),console.log("document.execCommand('copy'); is not supported"),prompt("Copy the text below. (ctrl c, enter)",t)}finally{"undefined"==typeof n&&e.remove()}}function dCr(t,e){var n=$(window).width(),i=$(window).height();return[Math.round(t/n),Math.round(e/i)]}function positM(t,e,n){var i=($(n),[0,0]);dCr(t,e)[1]&&(i[0]=-$(n).height()),dCr(t,e)[0]&&(i[1]=-$(n).width()),$(n).css("top",e+i[0]+5+"px"),$(n).css("left",t+i[1]+5+"px"),$(n).text(dCr(t,e))}function randomgen(t,e){for(var n=15;n--;){var i=fabric.util.getRandomInt(30,60),a=["Rect","Triangle","Circle"][fabric.util.getRandomInt(0,2)],o={top:fabric.util.getRandomInt(0,600)+t||0,left:fabric.util.getRandomInt(0,600)+e||0,fill:"pink"};"Circle"===a?o.radius=i:(o.width=i,o.height=i),canvas.add(new fabric[a](o))}}function fact(t){return t>1?t*fact(t-1):1}function ni(t,e){return fact(t)/(fact(e)*fact(t-e))}function bin(t,e,n){return ni(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e)}function bezier(t,e){for(var n=0,i=0,a=0;a<e.length;a++)n+=e[a].x*bin(e.length-1,a,t),i+=e[a].y*bin(e.length-1,a,t);return{x:n,y:i}}canvas=new fabric.Canvas("c"),canvas.setHeight($(window).height()),canvas.setWidth($(window).width()),canvas.selection=!1,canvas.hoverCursor="pointer",$(window).on("resize",function(){canvas.setHeight($(window).height()),canvas.setWidth($(window).width()),retina()}),retina();var offsetX=0,offsetY=0,PRX,PRY,CAN=!1,SHOWMENU=!1;canvas.on({"mouse:down":function(t){$("#callback").hide(),t.target&&(t.target.opacity=.5,canvas.renderAll())},"mouse:up":function(t){t.target&&(t.target.opacity=1,canvas.renderAll()),null==canvas.getActiveObject()},"mouse:move":function(t){},"object:moved":function(t){t.target.opacity=.5},"object:modified":function(t){t.target.opacity=1,t.target.point&&(maps[t.target.point].x=t.target.left,maps[t.target.point].y=t.target.top)}}),fabric.Object.prototype.transparentCorners=!1;for(var n=0;n<canvas.getObjects().length;n++)canvas.item(n).hasControls=canvas.item(n).hasBorders=!1;for(var source=[0,0,2e3,1e3,0,2e3,1e3,1e3,2e3,2e3,3e3,2500,2e3,0,0,0],scale=1,i=0;i<source.length;i++)source[i]=source[i]/scale;for(var maps=[],i=0,j=0;i<source.length;i+=2,j++)maps[j]={},maps[j].x=source[i],maps[j].y=source[i+1];for(var i=0;i<maps.length;i++){var text=new fabric.Text(i+"",{fontSize:15,hasControls:!1,textDecoration:"underline",backgroundColor:"pink",left:maps[i].x,top:maps[i].y,lineHeight:1,originX:"left",fontFamily:"Gill Sans",fontWeight:"bold",point:i});canvas.add(text)}var point={},t=0,step=5e-6,t=0,contentLoader,SETLOCAL=!1;$(window).bind("mousewheel",function(e){$("mouse").hide(500),t>.4&&.6>t?(canvas.isDrawingMode=!0,brusher(5*(t-.4),normselect)):canvas.isDrawingMode=!1,!contentLoader&&SETLOCAL&&(loadContent(),contentLoader=1,normselect());var n=e.originalEvent.wheelDelta;animationWheel(n),canvas.getActiveObject()&&(canvas.getActiveObject().left+=n/1e3),1>t?(n>0?t+=step*Math.abs(n):t>0?t-=step*Math.abs(n):t=.99,point=bezier(t,maps),canvas.absolutePan(new fabric.Point(offsetX+point.x,offsetY+point.y))):t=0}),$(window).on("keypress",function(t){});var text=new fabric.Text("press c to copy canvas data",{fontSize:15,backgroundColor:"hotpink",left:0,top:0,lineHeight:1,originX:"left",fontFamily:"Gill Sans",fontWeight:"light"});canvas.add(text),$(document).ready(function(){normselect()}),canvas.renderAll();